
‚ñ∂Ô∏è START: normalize_names (2025-07-26 09:11:16 AM EDT)
‚úÖ Wrote 16 rows to data/adjusted/pitchers_home.csv
‚úÖ Wrote 15 rows to data/adjusted/pitchers_away.csv
‚èπÔ∏è END: normalize_names (2025-07-26 09:11:16 AM EDT)

‚ñ∂Ô∏è START: tag_master_files (2025-07-26 09:11:17 AM EDT)
‚ö†Ô∏è 9 batters rows had no team/type match and will be dropped:
last_name, first_name
    Rooker Jr., Brent
    Wilson Jr., Jacob
    Alexander Jr., Cj
    Gurriel Jr., Yuli
    Yoshida, Masataka
       Friedl Jr., Tj
   Mullins Ii, Cedric
 Springer Iii, George
     Melendez Jr., Mj
‚úÖ Tagged batters: data/tagged/batters_normalized.csv (618 rows)
‚ö†Ô∏è 10 pitchers rows had no team/type match and will be dropped:
 last_name, first_name
        Carrillo, Alex
Harrington Iii, Thomas
       Schlittler, Cam
        Fulmer, Carson
    Misiewicz, Anthony
       Maton Iii, Phil
          Manaea, Sean
           Ortiz, Luis
  Alexander Jr., Scott
    Cortes Jr., Nestor
‚úÖ Tagged pitchers: data/tagged/pitchers_normalized.csv (689 rows)
‚èπÔ∏è END: tag_master_files (2025-07-26 09:11:17 AM EDT)

‚ñ∂Ô∏è START: validate_tagged_players (2025-07-26 09:11:17 AM EDT)
‚èπÔ∏è END: validate_tagged_players (2025-07-26 09:11:17 AM EDT)

‚ñ∂Ô∏è START: deduplicate_normalized (2025-07-26 09:11:17 AM EDT)
‚èπÔ∏è END: deduplicate_normalized (2025-07-26 09:11:17 AM EDT)

‚ñ∂Ô∏è START: normalize_lineups (2025-07-26 09:11:18 AM EDT)
‚úÖ normalize_lineups.py completed: 300 rows written to data/raw/lineups_normalized.csv
‚èπÔ∏è END: normalize_lineups (2025-07-26 09:11:18 AM EDT)

‚ñ∂Ô∏è START: normalize_todays_games (2025-07-26 09:11:18 AM EDT)
üì• Loading input files...
üßº Normalizing pitcher names...
‚ùå Unrecognized pitcher(s) found:
   home_team away_team       pitcher_home         pitcher_away
0        TOR        SF         Eric Lauer           Logan Webb
1        NYM       CIN        Clay Holmes        Nick Martinez
2        MIA        KC      Cal Quantrill        Michael Wacha
3        PHI       LAA     Taijuan Walker        Yusei Kikuchi
4        PIT       CHW       Mike Burrows        Adrian Houser
5        WSH        SD    Mitchell Parker           Yu Darvish
6         TB       BAL       Zack Littell          Dean Kremer
7        TEX       DET       Kumar Rocker       Keider Montero
8        CLE       ATH        Logan Allen        Luis Severino
9        ATL       NYY         Joey Wentz          Will Warren
10       CHC       BOS      Shota Imanaga         Brayan Bello
11       ARI       STL        Ryne Nelson           Sonny Gray
12       COL       MIN  Antonio Senzatela       Zebby Matthews
13       LAD       MIL      Emmet Sheehan       Freddy Peralta
14       SEA       HOU        Logan Evans  Lance McCullers Jr.
‚èπÔ∏è END: normalize_todays_games (2025-07-26 09:11:18 AM EDT)

‚ñ∂Ô∏è START: refresh_stadium_metadata (2025-07-26 09:11:19 AM EDT)
‚úÖ Saved updated stadium metadata for 15 home teams to data/Data/stadium_metadata.csv
‚èπÔ∏è END: refresh_stadium_metadata (2025-07-26 09:11:19 AM EDT)

‚ñ∂Ô∏è START: apply_team_name_mapping (2025-07-26 09:11:19 AM EDT)
‚úÖ Updated: data/raw/todaysgames_normalized.csv
‚úÖ Updated: data/Data/stadium_metadata.csv
‚èπÔ∏è END: apply_team_name_mapping (2025-07-26 09:11:19 AM EDT)

‚ñ∂Ô∏è START: update_game_time (2025-07-26 09:11:19 AM EDT)
‚úÖ Game times and park factors updated for 15 teams.
‚èπÔ∏è END: update_game_time (2025-07-26 09:11:19 AM EDT)

‚ñ∂Ô∏è START: filter_stadium_metadata (2025-07-26 09:11:20 AM EDT)
‚èπÔ∏è END: filter_stadium_metadata (2025-07-26 09:11:20 AM EDT)

‚ñ∂Ô∏è START: normalize_batter_team_names (2025-07-26 09:11:20 AM EDT)
‚èπÔ∏è END: normalize_batter_team_names (2025-07-26 09:11:20 AM EDT)

‚ñ∂Ô∏è START: split_batters_by_home_away (2025-07-26 09:11:20 AM EDT)
‚èπÔ∏è END: split_batters_by_home_away (2025-07-26 09:11:20 AM EDT)

‚ñ∂Ô∏è START: commit_split_batters (2025-07-26 09:11:21 AM EDT)
‚èπÔ∏è END: commit_split_batters (2025-07-26 09:11:21 AM EDT)

‚ñ∂Ô∏è START: normalize_pitcher_home_away (2025-07-26 09:11:21 AM EDT)
‚úÖ Wrote 16 rows to data/adjusted/pitchers_home.csv
‚úÖ Wrote 15 rows to data/adjusted/pitchers_away.csv
‚ö†Ô∏è Mismatch: Expected 30 total pitchers, but only 31 were matched.
‚èπÔ∏è END: normalize_pitcher_home_away (2025-07-26 09:11:21 AM EDT)

‚ñ∂Ô∏è START: update_pitcher_team_names (2025-07-26 09:11:22 AM EDT)
‚èπÔ∏è END: update_pitcher_team_names (2025-07-26 09:11:22 AM EDT)

‚ñ∂Ô∏è START: generate_weather_csv (2025-07-26 09:11:22 AM EDT)
‚úÖ Weather input file generated
üî¢ Rows: 15
üìÅ Output: data/weather_input.csv
üìÑ Games file: data/raw/todaysgames_normalized.csv
üèüÔ∏è Stadium file: data/Data/stadium_metadata.csv
‚úÖ Git commit and push complete.
‚èπÔ∏è END: generate_weather_csv (2025-07-26 09:11:22 AM EDT)

‚ñ∂Ô∏è START: filter_today_batters (2025-07-26 09:11:23 AM EDT)
üì• Loading lineups and batters...
‚úÖ Filtered down to 258 batters
‚ö†Ô∏è 56 unmatched batters found. Writing to data/cleaned/unmatched_batters.txt
üíæ Saved filtered batters to data/cleaned/batters_today.csv
‚èπÔ∏è END: filter_today_batters (2025-07-26 09:11:23 AM EDT)

‚ñ∂Ô∏è START: get_weather_data (2025-07-26 09:11:23 AM EDT)
2025-07-26 01:11:24 PM üîÑ Reading input file...
2025-07-26 01:11:24 PM üåç Fetching weather for 15 venues...
2025-07-26 01:11:26 PM ‚úÖ Weather data written to data/weather_adjustments.csv
‚èπÔ∏è END: get_weather_data (2025-07-26 09:11:23 AM EDT)

‚ñ∂Ô∏è START: apply_weather_adjustment (2025-07-26 09:11:27 AM EDT)
Loading input files...
Files loaded successfully.
Applying weather adjustments for home batters...
‚ö†Ô∏è Warning: No weather data merged for batters_home. Check if 'home' team names in input match 'home_team' in weather_adjustments.csv.
Applying weather adjustments for away batters...
‚ö†Ô∏è Warning: No weather data merged for batters_away. Check if 'away' team names in input match 'away_team' in weather_adjustments.csv.
Saving adjusted data...
Adjusted data saved to data/adjusted/batters_home_weather.csv and data/adjusted/batters_away_weather.csv
Writing adjustment logs...
Logs written to log_weather_home.txt and log_weather_away.txt
‚èπÔ∏è END: apply_weather_adjustment (2025-07-26 09:11:27 AM EDT)

‚ñ∂Ô∏è START: apply_park_adjustment (2025-07-26 09:11:27 AM EDT)
[main 72e49c8] Force commit: adjusted park batters + log
 4 files changed, 4 insertions(+), 4 deletions(-)
Home batters adjusted: 0
Away batters adjusted: 0
‚úÖ Committed and pushed adjusted park files.
‚èπÔ∏è END: apply_park_adjustment (2025-07-26 09:11:27 AM EDT)

‚ñ∂Ô∏è START: combine_weather_park_home (2025-07-26 09:11:28 AM EDT)
[main 8aefdc1] Auto-commit: Combined home batter adjustments
 1 file changed, 1 insertion(+), 1 deletion(-)
‚úÖ Merged rows: 0
‚úÖ Forced commit and push to repo.
‚èπÔ∏è END: combine_weather_park_home (2025-07-26 09:11:28 AM EDT)

‚ñ∂Ô∏è START: combine_weather_park_away (2025-07-26 09:11:29 AM EDT)
[main 81c0adf] Auto-commit: Combined away batter adjustments
 1 file changed, 1 insertion(+), 1 deletion(-)
üì• Loading input CSVs...
üîπ Weather rows: 0
üîπ Park rows: 0
üîÄ Merging weather and park adjustment files...
‚úÖ Merged rows: 0
üìä Columns in merged data: ['name', 'player_id', 'team', 'type', 'last_name, first_name', 'year', 'player_age', 'ab', 'pa', 'hit', 'single', 'double', 'triple', 'home_run', 'strikeout', 'walk', 'k_percent', 'bb_percent', 'batting_avg', 'slg_percent', 'on_base_percent', 'on_base_plus_slg', 'xba', 'xslg', 'woba', 'xwoba', 'xobp', 'xiso', 'avg_swing_speed', 'fast_swing_rate', 'blasts_contact', 'blasts_swing', 'squared_up_contact', 'squared_up_swing', 'avg_swing_length', 'swords', 'attack_angle', 'attack_direction', 'ideal_angle_rate', 'vertical_swing_path', 'exit_velocity_avg', 'launch_angle_avg', 'sweet_spot_percent', 'barrel_batted_rate', 'hard_hit_percent', 'avg_best_speed', 'avg_hyper_speed', 'whiff_percent', 'swing_percent', 'home_away', 'venue', 'location', 'temperature', 'wind_speed', 'wind_direction', 'humidity', 'precipitation', 'condition', 'notes', 'game_time', 'home_team', 'away_team', 'fetched_at', 'adj_woba_weather', 'adj_woba_park']
‚ö†Ô∏è No rows matched between weather and park files. Check name/team formatting.
üíæ Saved combined file to: data/adjusted/batters_away_adjusted.csv
üìù Wrote top 5 log to: data/adjusted/log_combined_away.txt
üì§ Committing and pushing results...
‚úÖ Git commit & push successful.
‚èπÔ∏è END: combine_weather_park_away (2025-07-26 09:11:29 AM EDT)

‚ñ∂Ô∏è START: normalize_pitcher_weather_outputs (2025-07-26 09:11:30 AM EDT)
[main caed836] Normalize pitchers before weather adjustment
 2 files changed, 31 insertions(+), 31 deletions(-)
‚úÖ Forced commit and push to repo.
‚èπÔ∏è END: normalize_pitcher_weather_outputs (2025-07-26 09:11:30 AM EDT)

‚ñ∂Ô∏è START: fix_away_team_column (2025-07-26 09:11:31 AM EDT)
‚ÑπÔ∏è Column 'away_team_y' not found. No changes made.
‚èπÔ∏è END: fix_away_team_column (2025-07-26 09:11:31 AM EDT)

‚ñ∂Ô∏è START: preprocess_pitcher_weather_park_away (2025-07-26 09:11:31 AM EDT)
‚èπÔ∏è END: preprocess_pitcher_weather_park_away (2025-07-26 09:11:31 AM EDT)

‚ñ∂Ô∏è START: add_team_alias_columns (2025-07-26 09:11:32 AM EDT)
[main cd82c41] Add team alias columns to pitcher files
 2 files changed, 33 insertions(+), 33 deletions(-)
‚úÖ Added 'home_team' to data/adjusted/pitchers_home.csv (16 rows)
‚úÖ Added 'away_team' to data/adjusted/pitchers_away.csv (15 rows)
üìù Log saved to log_add_team_alias_columns.txt
‚èπÔ∏è END: add_team_alias_columns (2025-07-26 09:11:32 AM EDT)

‚ñ∂Ô∏è START: add_team_columns_to_weather (2025-07-26 09:11:33 AM EDT)
‚úÖ Wrote home_team and away_team to data/weather_teams.csv
‚èπÔ∏è END: add_team_columns_to_weather (2025-07-26 09:11:33 AM EDT)

‚ñ∂Ô∏è START: apply_pitcher_weather_adjustment (2025-07-26 09:11:33 AM EDT)
‚úÖ Git commit and push complete for pitcher weather adjustments.
‚èπÔ∏è END: apply_pitcher_weather_adjustment (2025-07-26 09:11:33 AM EDT)

‚ñ∂Ô∏è START: apply_pitcher_park_adjustment (2025-07-26 09:11:34 AM EDT)
‚úÖ Wrote data/adjusted/pitchers_home_park.csv with 16 rows.
üìù Log written to log_pitchers_home_park.txt
‚úÖ Wrote data/adjusted/pitchers_away_park.csv with 15 rows.
üìù Log written to log_pitchers_away_park.txt
‚úÖ Git commit and push complete for pitcher park adjustments.
‚èπÔ∏è END: apply_pitcher_park_adjustment (2025-07-26 09:11:34 AM EDT)

‚ñ∂Ô∏è START: normalize_pitcher_merge_inputs (2025-07-26 09:11:35 AM EDT)
‚úÖ Normalized and saved: data/adjusted/pitchers_home_weather.csv
‚úÖ Normalized and saved: data/adjusted/pitchers_home_park.csv
‚úÖ Normalized and saved: data/adjusted/pitchers_away_weather.csv
‚úÖ Normalized and saved: data/adjusted/pitchers_away_park.csv
‚èπÔ∏è END: normalize_pitcher_merge_inputs (2025-07-26 09:11:35 AM EDT)

‚ñ∂Ô∏è START: combine_pitcher_weather_park_home (2025-07-26 09:11:36 AM EDT)
[main 6d7fe2b] Auto-commit: Cleaned combine pitcher weather + park (home)
 1 file changed, 19 insertions(+), 19 deletions(-)
‚èπÔ∏è END: combine_pitcher_weather_park_home (2025-07-26 09:11:36 AM EDT)

‚ñ∂Ô∏è START: combine_pitcher_weather_park_away (2025-07-26 09:11:37 AM EDT)
[main c22c96c] Auto-commit: Cleaned combine pitcher weather + park (away)
 1 file changed, 16 insertions(+), 16 deletions(-)
‚èπÔ∏è END: combine_pitcher_weather_park_away (2025-07-26 09:11:37 AM EDT)

‚ñ∂Ô∏è START: prep_merge (2025-07-26 09:11:38 AM EDT)
[main 946b4c1] prep_merge: normalize team casing and enforce name match
 2 files changed, 35 insertions(+), 35 deletions(-)
‚úÖ Git commit and push complete.
‚úÖ Team and name normalization complete.
‚èπÔ∏è END: prep_merge (2025-07-26 09:11:38 AM EDT)

‚ñ∂Ô∏è START: chain_setup_inputs (2025-07-26 09:11:39 AM EDT)
Copying input files...
Copied: batters_home_weather_park.csv
Copied: batters_away_weather_park.csv
Copied: pitchers_home_weather_park.csv
Copied: pitchers_away_weather_park.csv
Copied: todaysgames_normalized.csv
All files copied.
‚èπÔ∏è END: chain_setup_inputs (2025-07-26 09:11:39 AM EDT)

‚ñ∂Ô∏è START: clean_and_preprocess_games (2025-07-26 09:11:39 AM EDT)
üîß Cleaning and preprocessing game-level data...
‚úÖ Saved cleaned game data to: data/end_chain/cleaned/games_cleaned.csv
‚èπÔ∏è END: clean_and_preprocess_games (2025-07-26 09:11:39 AM EDT)

‚ñ∂Ô∏è START: normalize_games_pitchers (2025-07-26 09:11:39 AM EDT)
‚úÖ Normalized pitcher names written to data/end_chain/cleaned/games_cleaned.csv
‚èπÔ∏è END: normalize_games_pitchers (2025-07-26 09:11:39 AM EDT)

‚ñ∂Ô∏è START: normalize_pitchers_xtra (2025-07-26 09:11:39 AM EDT)
üîÑ Normalizing names in pitchers_xtra.csv...
‚úÖ Output written to data/end_chain/cleaned/pitchers_xtra_normalized.csv
‚èπÔ∏è END: normalize_pitchers_xtra (2025-07-26 09:11:39 AM EDT)

‚ñ∂Ô∏è START: clean_merge_files (2025-07-26 09:11:40 AM EDT)
Cleaning file: data/end_chain/pitchers_home_weather_park.csv
üîç Removed 3 duplicate rows in data/end_chain/pitchers_home_weather_park.csv
‚úÖ pitchers_home cleaned and saved.
Cleaning file: data/end_chain/pitchers_away_weather_park.csv
üîç Removed 0 duplicate rows in data/end_chain/pitchers_away_weather_park.csv
‚úÖ pitchers_away cleaned and saved.
‚èπÔ∏è END: clean_merge_files (2025-07-26 09:11:40 AM EDT)

‚ñ∂Ô∏è START: chain_load_data (2025-07-26 09:11:40 AM EDT)
--- Starting Data Loading Process ---
Loading games from data/end_chain/todaysgames_normalized.csv...
‚úÖ Loaded games. Shape: (15, 5)
Loading batters_home from data/end_chain/batters_home_weather_park.csv...
‚úÖ Loaded batters_home. Shape: (125, 71)
Loading batters_away from data/end_chain/batters_away_weather_park.csv...
‚úÖ Loaded batters_away. Shape: (131, 112)
Loading pitchers_home from data/end_chain/pitchers_home_weather_park.csv...
‚úÖ Loaded pitchers_home. Shape: (15, 6)
Loading pitchers_away from data/end_chain/pitchers_away_weather_park.csv...
‚úÖ Loaded pitchers_away. Shape: (15, 6)
--- Data Loading Complete ---
‚èπÔ∏è END: chain_load_data (2025-07-26 09:11:40 AM EDT)

‚ñ∂Ô∏è START: rename_and_merge_pitcher_data (2025-07-26 09:11:41 AM EDT)
‚úÖ Cleaned and updated: pitchers_home_weather_park.csv
‚úÖ Cleaned and updated: pitchers_away_weather_park.csv
‚èπÔ∏è END: rename_and_merge_pitcher_data (2025-07-26 09:11:41 AM EDT)

‚ñ∂Ô∏è START: pit_clean1 (2025-07-26 09:11:41 AM EDT)
‚úÖ Updated names in pitchers_home_weather_park.csv
‚úÖ Updated names in pitchers_away_weather_park.csv
‚úÖ Synced 'home_team' with 'team' in batters_home_cleaned.csv
‚èπÔ∏è END: pit_clean1 (2025-07-26 09:11:41 AM EDT)

‚ñ∂Ô∏è START: merge_data (2025-07-26 09:11:41 AM EDT)
2025-07-26 13:11:41,973 - INFO - üîó Starting merge process...
2025-07-26 13:11:41,973 - INFO - ‚è≥ Loading batters_home from data/end_chain/cleaned/batters_home_cleaned.csv...
2025-07-26 13:11:41,976 - INFO - ‚úÖ Loaded batters_home with 15 rows and 61 columns.
2025-07-26 13:11:41,976 - INFO - ‚è≥ Loading batters_away from data/end_chain/cleaned/batters_away_cleaned.csv...
2025-07-26 13:11:41,978 - INFO - ‚úÖ Loaded batters_away with 15 rows and 61 columns.
2025-07-26 13:11:41,978 - INFO - ‚è≥ Loading pitchers_home from data/end_chain/cleaned/pitchers_home_cleaned.csv...
2025-07-26 13:11:41,980 - INFO - ‚úÖ Loaded pitchers_home with 14 rows and 11 columns.
2025-07-26 13:11:41,980 - INFO - ‚è≥ Loading pitchers_away from data/end_chain/cleaned/pitchers_away_cleaned.csv...
2025-07-26 13:11:41,981 - INFO - ‚úÖ Loaded pitchers_away with 15 rows and 11 columns.
2025-07-26 13:11:41,981 - INFO - ‚è≥ Loading games from data/end_chain/cleaned/games_cleaned.csv...
2025-07-26 13:11:41,982 - INFO - ‚úÖ Loaded games with 15 rows and 5 columns.
2025-07-26 13:11:41,982 - INFO - üîç Validating columns for games...
2025-07-26 13:11:41,982 - INFO - ‚úÖ All required columns present in games.
2025-07-26 13:11:41,982 - INFO - üîç Validating columns for batters_home...
2025-07-26 13:11:41,982 - INFO - ‚úÖ All required columns present in batters_home.
2025-07-26 13:11:41,982 - INFO - üîç Validating columns for batters_away...
2025-07-26 13:11:41,982 - ERROR - ‚ùå batters_away is missing required columns: ['team']
2025-07-26 13:11:41,982 - CRITICAL - ‚ùå Column validation failed: batters_away is missing required columns: ['team']
‚èπÔ∏è END: merge_data (2025-07-26 09:11:41 AM EDT)

