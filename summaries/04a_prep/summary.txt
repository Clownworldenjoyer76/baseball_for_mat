===== RUN TIMESTAMP: 2025-09-03 02:09:47 PM EDT =====

===== STATUS =====
‚úÖ python succeeded [2025-09-03 02:09:40 PM EDT]
‚úÖ python succeeded [2025-09-03 02:09:40 PM EDT]
‚úÖ python succeeded [2025-09-03 02:09:41 PM EDT]
‚úÖ python succeeded [2025-09-03 02:09:41 PM EDT]
‚úÖ python succeeded [2025-09-03 02:09:41 PM EDT]
‚úÖ python succeeded [2025-09-03 02:09:42 PM EDT]
‚úÖ python succeeded [2025-09-03 02:09:43 PM EDT]
‚úÖ python succeeded [2025-09-03 02:09:44 PM EDT]
‚úÖ python succeeded [2025-09-03 02:09:44 PM EDT]
‚úÖ python succeeded [2025-09-03 02:09:44 PM EDT]
‚úÖ python succeeded [2025-09-03 02:09:45 PM EDT]
‚úÖ python succeeded [2025-09-03 02:09:45 PM EDT]
‚úÖ python succeeded [2025-09-03 02:09:45 PM EDT]
‚ùå python failed [2025-09-03 02:09:46 PM EDT]
‚ùå python failed [2025-09-03 02:09:46 PM EDT]
‚ùå python failed [2025-09-03 02:09:46 PM EDT]
‚úÖ python succeeded [2025-09-03 02:09:47 PM EDT]
‚úÖ python succeeded [2025-09-03 02:09:47 PM EDT]
‚úÖ python succeeded [2025-09-03 02:09:47 PM EDT]

===== LOG =====
‚ñ∂Ô∏è START: prep_merge.py (2025-09-03 02:09:39 PM EDT)
[main 1f8f35ed] prep_merge: stage files (player_id/game_id-based)
 5 files changed, 132 insertions(+), 130 deletions(-)
Saved pitchers home ‚Üí data/end_chain/first/pit_hwp.csv
Saved pitchers away ‚Üí data/end_chain/first/pit_awp.csv
Saved cleaned batters away ‚Üí data/end_chain/first/raw/bat_awp_dirty.csv
Saved batters home ‚Üí data/end_chain/first/raw/bat_hwp_dirty.csv
Copied games file ‚Üí data/end_chain/first/games_today.csv
Git commit/push complete.
‚èπÔ∏è END: python (2025-09-03 02:09:40 PM EDT)

‚ñ∂Ô∏è START: chain_load_data.py (2025-09-03 02:09:40 PM EDT)
--- Starting Data Loading Process ---
Loading games from data/end_chain/first/games_today.csv...
‚úÖ Loaded games. Shape: (15, 11)
Loading batters_home from data/end_chain/first/raw/bat_hwp_dirty.csv...
‚úÖ Loaded batters_home. Shape: (42, 5)
Loading batters_away from data/end_chain/first/raw/bat_awp_dirty.csv...
‚úÖ Loaded batters_away. Shape: (48, 5)
Loading pitchers_home from data/end_chain/first/pit_hwp.csv...
‚úÖ Loaded pitchers_home. Shape: (14, 5)
Loading pitchers_away from data/end_chain/first/pit_awp.csv...
‚úÖ Loaded pitchers_away. Shape: (13, 5)
--- Data Loading Complete ---
‚èπÔ∏è END: python (2025-09-03 02:09:40 PM EDT)

‚ñ∂Ô∏è START: clean_and_preprocess_games.py (2025-09-03 02:09:40 PM EDT)
‚úÖ Saved cleaned games file ‚Üí data/end_chain/cleaned/games_today_cleaned.csv (rows=15)
‚èπÔ∏è END: python (2025-09-03 02:09:41 PM EDT)

‚ñ∂Ô∏è START: normalize_pitchers_xtra.py (2025-09-03 02:09:41 PM EDT)
‚úÖ Wrote 27 rows ‚Üí data/end_chain/cleaned/pitchers_xtra_normalized.csv
‚èπÔ∏è END: python (2025-09-03 02:09:41 PM EDT)

‚ñ∂Ô∏è START: clean_merge_files.py (2025-09-03 02:09:41 PM EDT)
Cleaned data/end_chain/first/pit_hwp.csv ‚Üí removed 0, remaining: 0
Cleaned data/end_chain/first/pit_awp.csv ‚Üí removed 0, remaining: 0
Cleaned data/end_chain/first/raw/bat_awp_dirty.csv ‚Üí removed 0, remaining: 0
Cleaned data/end_chain/first/raw/bat_hwp_dirty.csv ‚Üí removed 0, remaining: 0

‚úÖ Duplicate cleanup complete. Summary written to data/end_chain/duplicates.txt
‚èπÔ∏è END: python (2025-09-03 02:09:41 PM EDT)

‚ñ∂Ô∏è START: finalbatawp.py (2025-09-03 02:09:41 PM EDT)
[main d809f8c2] üìä Build finalbatawp.csv from dirty AWP; player_id & game_id merges; 100-based park factors
 1 file changed, 48 insertions(+), 48 deletions(-)
‚Äî Building finalbatawp (dirty AWP, player_id & game_id merges) ‚Äî
üìù Wrote data/end_chain/final/finalbatawp.csv (rows=48)
‚ÜóÔ∏è Pushed to repository.
‚èπÔ∏è END: python (2025-09-03 02:09:42 PM EDT)

‚ñ∂Ô∏è START: finalbathwp.py (2025-09-03 02:09:42 PM EDT)
[main daf190ff] finalbathwp: game_id merge + 100-based park factors (day/night/roof_closed)
 1 file changed, 42 insertions(+), 42 deletions(-)
üìù Wrote data/end_chain/final/finalbathwp.csv (rows=42, cols=12)
‚úÖ Committed and pushed finalbathwp.csv
‚èπÔ∏è END: python (2025-09-03 02:09:43 PM EDT)

‚ñ∂Ô∏è START: bat_1.py (2025-09-03 02:09:43 PM EDT)
üîÑ Processing data/end_chain/final/finalbatawp.csv...
  ‚úÖ No columns ending in '_y' found to drop.
  ‚úÖ No columns identified for deletion in this step.
  ‚úÖ No columns ending in '_x' found to rename.
‚úÖ Successfully saved processed data to data/end_chain/final/updating/bat_away1.csv
------------------------------
Beginning processing for bat_away2.csv with specific column deletions...
üîÑ Processing data/end_chain/final/finalbatawp.csv...
  ‚úÖ No columns ending in '_y' found to drop.
  üóëÔ∏è Identified additional columns for deletion: ['pitcher_away', 'pitcher_home', 'team']
  üóëÔ∏è Dropped total columns: ['pitcher_home', 'pitcher_away']
  ‚úÖ No columns ending in '_x' found to rename.
‚úÖ Successfully saved processed data to data/end_chain/final/updating/bat_away2.csv
------------------------------
üîÑ Processing data/end_chain/final/finalbathwp.csv...
  ‚úÖ No columns ending in '_y' found to drop.
  ‚úÖ No columns identified for deletion in this step.
  ‚úÖ No columns ending in '_x' found to rename.
‚úÖ Successfully saved processed data to data/end_chain/final/updating/bat_home1.csv

Processing complete for bat_1.py.
‚èπÔ∏è END: python (2025-09-03 02:09:44 PM EDT)

‚ñ∂Ô∏è START: bat_2.py (2025-09-03 02:09:44 PM EDT)
üîÑ Processing data/end_chain/final/updating/bat_home1.csv for bat_home2.csv...
  Checking for _input and _adj columns for conditional processing...
  ‚úÖ No conditional drops or renames.
  ‚ûï Added column: 'location'
  ‚ûï Added column: 'notes'
  ‚ûï Added column: 'precipitation'
‚úÖ Normalized 'home_team' to title case.
‚úÖ Saved processed data to data/end_chain/final/updating/bat_home2.csv

==================================================

üîÑ Processing data/end_chain/final/updating/bat_away1.csv for bat_away2.csv...
  ‚ûï Added column: 'state'
  ‚ûï Added column: 'timezone'
  ‚ûï Added column: 'is_dome'
‚úÖ Saved processed data to data/end_chain/final/updating/bat_away2.csv

Processing complete for bat_2.py.
‚èπÔ∏è END: python (2025-09-03 02:09:44 PM EDT)

‚ñ∂Ô∏è START: bat_away3.py (2025-09-03 02:09:44 PM EDT)
‚èπÔ∏è END: python (2025-09-03 02:09:44 PM EDT)

‚ñ∂Ô∏è START: bat_home3.py (2025-09-03 02:09:44 PM EDT)
‚èπÔ∏è END: python (2025-09-03 02:09:45 PM EDT)

‚ñ∂Ô∏è START: bat4.py (2025-09-03 02:09:45 PM EDT)
‚ùå Failed to inject 'pitcher_away'. Check for team name mismatches.
‚èπÔ∏è END: python (2025-09-03 02:09:45 PM EDT)

‚ñ∂Ô∏è START: woba_calc.py (2025-09-03 02:09:45 PM EDT)
‚ö†Ô∏è 'woba' column missing in bat_home3.csv, skipping adj_woba_weather
‚úÖ Updated: data/end_chain/final/updating/bat_home3.csv
‚úÖ Updated: data/end_chain/final/updating/bat_away4.csv
‚èπÔ∏è END: python (2025-09-03 02:09:45 PM EDT)

‚ñ∂Ô∏è START: pit1.py (2025-09-03 02:09:45 PM EDT)
‚èπÔ∏è END: python (2025-09-03 02:09:46 PM EDT)

‚ñ∂Ô∏è START: pit2.py (2025-09-03 02:09:46 PM EDT)
‚èπÔ∏è END: python (2025-09-03 02:09:46 PM EDT)

‚ñ∂Ô∏è START: end_prep.py (2025-09-03 02:09:46 PM EDT)
üîÑ Loading files...
‚úÖ Files loaded. Normalizing names...
‚èπÔ∏è END: python (2025-09-03 02:09:46 PM EDT)

‚ñ∂Ô∏è START: pit3.py (2025-09-03 02:09:46 PM EDT)
‚úÖ Updated pitcher stats and saved to: data/end_chain/final/startingpitchers_final.csv
‚èπÔ∏è END: python (2025-09-03 02:09:47 PM EDT)

‚ñ∂Ô∏è START: normalize_batters_projection_columns.py (2025-09-03 02:09:47 PM EDT)
‚úÖ Saved normalized batter projection data to: data/end_chain/final/normalize_end/all_bat_col.csv
‚èπÔ∏è END: python (2025-09-03 02:09:47 PM EDT)

‚ñ∂Ô∏è START: bat5.py (2025-09-03 02:09:47 PM EDT)
üîÑ Loading input files...
üõ†Ô∏è Filling batter_home_final.csv...
‚úÖ Updated: data/end_chain/final/batter_home_final.csv
üõ†Ô∏è Filling batter_away_final.csv...
‚úÖ Updated: data/end_chain/final/batter_away_final.csv
‚èπÔ∏è END: python (2025-09-03 02:09:47 PM EDT)


===== ERRORS =====
‚ùå python ERROR [2025-09-03 02:09:46 PM EDT]:
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'last_name, first_name'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/baseball_for_mat/baseball_for_mat/scripts/pit1.py", line 65, in <module>
    main()
  File "/home/runner/work/baseball_for_mat/baseball_for_mat/scripts/pit1.py", line 37, in main
    today_pitchers["name_key"] = today_pitchers["last_name, first_name"].apply(normalize_name)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/pandas/core/frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'last_name, first_name'

---

‚ùå python ERROR [2025-09-03 02:09:46 PM EDT]:
Traceback (most recent call last):
  File "/home/runner/work/baseball_for_mat/baseball_for_mat/scripts/pit2.py", line 39, in <module>
    main()
  File "/home/runner/work/baseball_for_mat/baseball_for_mat/scripts/pit2.py", line 27, in main
    merged = bat_away.merge(
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/pandas/core/frame.py", line 10839, in merge
    return merge(
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/pandas/core/reshape/merge.py", line 184, in merge
    return op.get_result(copy=copy)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/pandas/core/reshape/merge.py", line 888, in get_result
    result = self._reindex_and_concat(
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/pandas/core/reshape/merge.py", line 840, in _reindex_and_concat
    llabels, rlabels = _items_overlap_with_suffix(
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/pandas/core/reshape/merge.py", line 2757, in _items_overlap_with_suffix
    raise MergeError(
pandas.errors.MergeError: Passing 'suffixes' which cause duplicate columns {'pitcher_home_x'} is not allowed.

---

‚ùå python ERROR [2025-09-03 02:09:46 PM EDT]:
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'last_name, first_name'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/baseball_for_mat/baseball_for_mat/scripts/end_prep.py", line 92, in <module>
    main()
  File "/home/runner/work/baseball_for_mat/baseball_for_mat/scripts/end_prep.py", line 47, in main
    bat_home["last_name, first_name"] = bat_home["last_name, first_name"].apply(enforce_last_first)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/pandas/core/frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'last_name, first_name'

---

