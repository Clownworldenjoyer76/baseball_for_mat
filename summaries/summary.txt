===== RUN TIMESTAMP: 2025-07-26 11:17:19 AM EDT =====

===== STATUS =====

âœ… normalize_names succeeded [2025-07-26 11:16:57 AM EDT]
âœ… tag_master_files succeeded [2025-07-26 11:16:58 AM EDT]
âŒ validate_tagged_players failed [2025-07-26 11:16:58 AM EDT]
âœ… deduplicate_normalized succeeded [2025-07-26 11:16:58 AM EDT]
âœ… normalize_lineups succeeded [2025-07-26 11:16:59 AM EDT]
âœ… normalize_todays_games succeeded [2025-07-26 11:16:59 AM EDT]
âœ… refresh_stadium_metadata succeeded [2025-07-26 11:16:59 AM EDT]
âœ… apply_team_name_mapping succeeded [2025-07-26 11:17:00 AM EDT]
âœ… update_game_time succeeded [2025-07-26 11:17:00 AM EDT]
âœ… filter_stadium_metadata succeeded [2025-07-26 11:17:00 AM EDT]
âœ… normalize_batter_team_names succeeded [2025-07-26 11:17:01 AM EDT]
âœ… split_batters_by_home_away succeeded [2025-07-26 11:17:01 AM EDT]
âœ… commit_split_batters succeeded [2025-07-26 11:17:01 AM EDT]
âœ… normalize_pitcher_home_away succeeded [2025-07-26 11:17:01 AM EDT]
âœ… update_pitcher_team_names succeeded [2025-07-26 11:17:02 AM EDT]
âœ… generate_weather_csv succeeded [2025-07-26 11:17:02 AM EDT]
âœ… filter_today_batters succeeded [2025-07-26 11:17:03 AM EDT]
âœ… get_weather_data succeeded [2025-07-26 11:17:03 AM EDT]
âœ… apply_weather_adjustment succeeded [2025-07-26 11:17:06 AM EDT]
âœ… apply_park_adjustment succeeded [2025-07-26 11:17:06 AM EDT]
âœ… combine_weather_park_home succeeded [2025-07-26 11:17:07 AM EDT]
âœ… combine_weather_park_away succeeded [2025-07-26 11:17:08 AM EDT]
âœ… normalize_pitcher_weather_outputs succeeded [2025-07-26 11:17:09 AM EDT]
âœ… fix_away_team_column succeeded [2025-07-26 11:17:10 AM EDT]
âœ… preprocess_pitcher_weather_park_away succeeded [2025-07-26 11:17:10 AM EDT]
âœ… add_team_alias_columns succeeded [2025-07-26 11:17:10 AM EDT]
âœ… add_team_columns_to_weather succeeded [2025-07-26 11:17:11 AM EDT]
âœ… apply_pitcher_weather_adjustment succeeded [2025-07-26 11:17:12 AM EDT]
âœ… apply_pitcher_park_adjustment succeeded [2025-07-26 11:17:12 AM EDT]
âœ… normalize_pitcher_merge_inputs succeeded [2025-07-26 11:17:13 AM EDT]
âœ… combine_pitcher_weather_park_home succeeded [2025-07-26 11:17:14 AM EDT]
âœ… combine_pitcher_weather_park_away succeeded [2025-07-26 11:17:14 AM EDT]
âœ… prep_merge succeeded [2025-07-26 11:17:15 AM EDT]
âœ… chain_setup_inputs succeeded [2025-07-26 11:17:16 AM EDT]
âœ… clean_and_preprocess_games succeeded [2025-07-26 11:17:16 AM EDT]
âœ… normalize_games_pitchers succeeded [2025-07-26 11:17:17 AM EDT]
âœ… normalize_pitchers_xtra succeeded [2025-07-26 11:17:17 AM EDT]
âœ… clean_merge_files succeeded [2025-07-26 11:17:17 AM EDT]
âœ… chain_load_data succeeded [2025-07-26 11:17:18 AM EDT]
âœ… rename_and_merge_pitcher_data succeeded [2025-07-26 11:17:18 AM EDT]
âœ… pit_clean1 succeeded [2025-07-26 11:17:18 AM EDT]
âŒ merge_data failed [2025-07-26 11:17:19 AM EDT]

===== LOG =====

â–¶ï¸ START: normalize_names (2025-07-26 11:16:57 AM EDT)
ğŸ”„ Processing batters - data/normalized/batters_normalized.csv
âŒ Error processing batters: 0
ğŸ”„ Processing pitchers - data/normalized/pitchers_normalized.csv
âŒ Error processing pitchers: 0
â¹ï¸ END: normalize_names (2025-07-26 11:16:57 AM EDT)

â–¶ï¸ START: tag_master_files (2025-07-26 11:16:58 AM EDT)
â¹ï¸ END: tag_master_files (2025-07-26 11:16:58 AM EDT)

â–¶ï¸ START: validate_tagged_players (2025-07-26 11:16:58 AM EDT)
â¹ï¸ END: validate_tagged_players (2025-07-26 11:16:58 AM EDT)

â–¶ï¸ START: deduplicate_normalized (2025-07-26 11:16:58 AM EDT)
â¹ï¸ END: deduplicate_normalized (2025-07-26 11:16:58 AM EDT)

â–¶ï¸ START: normalize_lineups (2025-07-26 11:16:59 AM EDT)
âœ… normalize_lineups.py completed: 300 rows written to data/raw/lineups_normalized.csv
â¹ï¸ END: normalize_lineups (2025-07-26 11:16:59 AM EDT)

â–¶ï¸ START: normalize_todays_games (2025-07-26 11:16:59 AM EDT)
ğŸ“¥ Loading input files...
ğŸ§¼ Normalizing pitcher names...
âš ï¸ WARNING: Unmatched pitchers found â€” logging to unmatched_pitchers.csv
ğŸ” Mapping team abbreviations to full names...
â± Validating game times...
ğŸ” Checking for duplicate matchups...
âœ… normalize_todays_games completed: data/raw/todaysgames_normalized.csv
â¹ï¸ END: normalize_todays_games (2025-07-26 11:16:59 AM EDT)

â–¶ï¸ START: refresh_stadium_metadata (2025-07-26 11:16:59 AM EDT)
âœ… Saved updated stadium metadata for 15 home teams to data/Data/stadium_metadata.csv
â¹ï¸ END: refresh_stadium_metadata (2025-07-26 11:16:59 AM EDT)

â–¶ï¸ START: apply_team_name_mapping (2025-07-26 11:17:00 AM EDT)
âœ… Updated: data/raw/todaysgames_normalized.csv
âœ… Updated: data/Data/stadium_metadata.csv
â¹ï¸ END: apply_team_name_mapping (2025-07-26 11:17:00 AM EDT)

â–¶ï¸ START: update_game_time (2025-07-26 11:17:00 AM EDT)
âœ… Game times and park factors updated for 15 teams.
â¹ï¸ END: update_game_time (2025-07-26 11:17:00 AM EDT)

â–¶ï¸ START: filter_stadium_metadata (2025-07-26 11:17:00 AM EDT)
â¹ï¸ END: filter_stadium_metadata (2025-07-26 11:17:00 AM EDT)

â–¶ï¸ START: normalize_batter_team_names (2025-07-26 11:17:01 AM EDT)
â¹ï¸ END: normalize_batter_team_names (2025-07-26 11:17:01 AM EDT)

â–¶ï¸ START: split_batters_by_home_away (2025-07-26 11:17:01 AM EDT)
â¹ï¸ END: split_batters_by_home_away (2025-07-26 11:17:01 AM EDT)

â–¶ï¸ START: commit_split_batters (2025-07-26 11:17:01 AM EDT)
â¹ï¸ END: commit_split_batters (2025-07-26 11:17:01 AM EDT)

â–¶ï¸ START: normalize_pitcher_home_away (2025-07-26 11:17:01 AM EDT)
âœ… Wrote 0 rows to data/adjusted/pitchers_home.csv
âœ… Wrote 0 rows to data/adjusted/pitchers_away.csv
âš ï¸ Mismatch: Expected 30 total pitchers, but only 0 were matched.

=== MISSING HOME PITCHERS ===
Allen, Logan
Burrows, Mike
Evans, Logan
Holmes, Clay
Imanaga, Shota
Lauer, Eric
Littell, Zack
Nelson, Ryne
Parker, Mitchell
Quantrill, Cal
Rocker, Kumar
Senzatela, Antonio
Sheehan, Emmet
Walker, Taijuan
Wentz, Joey

=== MISSING AWAY PITCHERS ===
Bello, Brayan
Darvish, Yu
Gray, Sonny
Houser, Adrian
Kikuchi, Yusei
Kremer, Dean
Martinez, Nick
Matthews, Zebby
Mccullers Jr., Lance
Montero, Keider
Peralta, Freddy
Severino, Luis
Wacha, Michael
Warren, Will
Webb, Logan

âš ï¸ Unmatched team count: 30
Top 5 unmatched teams:
 - Angels
 - Astros
 - Athletics
 - Blue Jays
 - Braves
â¹ï¸ END: normalize_pitcher_home_away (2025-07-26 11:17:01 AM EDT)

â–¶ï¸ START: update_pitcher_team_names (2025-07-26 11:17:02 AM EDT)
â¹ï¸ END: update_pitcher_team_names (2025-07-26 11:17:02 AM EDT)

â–¶ï¸ START: generate_weather_csv (2025-07-26 11:17:02 AM EDT)
âœ… Weather input file generated
ğŸ”¢ Rows: 15
ğŸ“ Output: data/weather_input.csv
ğŸ“„ Games file: data/raw/todaysgames_normalized.csv
ğŸŸï¸ Stadium file: data/Data/stadium_metadata.csv
âœ… Git commit and push complete.
â¹ï¸ END: generate_weather_csv (2025-07-26 11:17:02 AM EDT)

â–¶ï¸ START: filter_today_batters (2025-07-26 11:17:03 AM EDT)
ğŸ“¥ Loading lineups and batters...
âœ… Filtered down to 0 batters
âš ï¸ 300 unmatched batters found. Writing to data/cleaned/unmatched_batters.txt
ğŸ’¾ Saved filtered batters to data/cleaned/batters_today.csv
â¹ï¸ END: filter_today_batters (2025-07-26 11:17:03 AM EDT)

â–¶ï¸ START: get_weather_data (2025-07-26 11:17:03 AM EDT)
2025-07-26 03:17:04 PM ğŸ”„ Reading input file...
2025-07-26 03:17:04 PM ğŸŒ Fetching weather for 15 venues...
2025-07-26 03:17:06 PM âœ… Weather data written to data/weather_adjustments.csv
â¹ï¸ END: get_weather_data (2025-07-26 11:17:03 AM EDT)

â–¶ï¸ START: apply_weather_adjustment (2025-07-26 11:17:06 AM EDT)
Loading input files...
Files loaded successfully.
Applying weather adjustments for home batters...
âš ï¸ Warning: No weather data merged for batters_home. Check if 'home' team names in input match 'home_team' in weather_adjustments.csv.
Applying weather adjustments for away batters...
âš ï¸ Warning: No weather data merged for batters_away. Check if 'away' team names in input match 'away_team' in weather_adjustments.csv.
Saving adjusted data...
Adjusted data saved to data/adjusted/batters_home_weather.csv and data/adjusted/batters_away_weather.csv
Writing adjustment logs...
Logs written to log_weather_home.txt and log_weather_away.txt
â¹ï¸ END: apply_weather_adjustment (2025-07-26 11:17:06 AM EDT)

â–¶ï¸ START: apply_park_adjustment (2025-07-26 11:17:06 AM EDT)
[main 267b657] Force commit: adjusted park batters + log
Home batters adjusted: 0
Away batters adjusted: 0
âœ… Committed and pushed adjusted park files.
â¹ï¸ END: apply_park_adjustment (2025-07-26 11:17:06 AM EDT)

â–¶ï¸ START: combine_weather_park_home (2025-07-26 11:17:07 AM EDT)
[main cf5e75b] Auto-commit: Combined home batter adjustments
âœ… Merged rows: 0
âœ… Forced commit and push to repo.
â¹ï¸ END: combine_weather_park_home (2025-07-26 11:17:07 AM EDT)

â–¶ï¸ START: combine_weather_park_away (2025-07-26 11:17:08 AM EDT)
[main a5529e8] Auto-commit: Combined away batter adjustments
ğŸ“¥ Loading input CSVs...
ğŸ”¹ Weather rows: 0
ğŸ”¹ Park rows: 0
ğŸ”€ Merging weather and park adjustment files...
âœ… Merged rows: 0
ğŸ“Š Columns in merged data: ['name', 'player_id', 'team', 'type', 'last_name, first_name', 'year', 'player_age', 'ab', 'pa', 'hit', 'single', 'double', 'triple', 'home_run', 'strikeout', 'walk', 'k_percent', 'bb_percent', 'batting_avg', 'slg_percent', 'on_base_percent', 'on_base_plus_slg', 'xba', 'xslg', 'woba', 'xwoba', 'xobp', 'xiso', 'avg_swing_speed', 'fast_swing_rate', 'blasts_contact', 'blasts_swing', 'squared_up_contact', 'squared_up_swing', 'avg_swing_length', 'swords', 'attack_angle', 'attack_direction', 'ideal_angle_rate', 'vertical_swing_path', 'exit_velocity_avg', 'launch_angle_avg', 'sweet_spot_percent', 'barrel_batted_rate', 'hard_hit_percent', 'avg_best_speed', 'avg_hyper_speed', 'whiff_percent', 'swing_percent', 'home_away', 'venue', 'location', 'temperature', 'wind_speed', 'wind_direction', 'humidity', 'precipitation', 'condition', 'notes', 'game_time', 'home_team', 'away_team', 'fetched_at', 'adj_woba_weather', 'adj_woba_park']
âš ï¸ No rows matched between weather and park files. Check name/team formatting.
ğŸ’¾ Saved combined file to: data/adjusted/batters_away_adjusted.csv
ğŸ“ Wrote top 5 log to: data/adjusted/log_combined_away.txt
ğŸ“¤ Committing and pushing results...
âœ… Git commit & push successful.
â¹ï¸ END: combine_weather_park_away (2025-07-26 11:17:08 AM EDT)

â–¶ï¸ START: normalize_pitcher_weather_outputs (2025-07-26 11:17:09 AM EDT)
[main 9447041] Normalize pitchers before weather adjustment
âœ… Forced commit and push to repo.
â¹ï¸ END: normalize_pitcher_weather_outputs (2025-07-26 11:17:09 AM EDT)

â–¶ï¸ START: fix_away_team_column (2025-07-26 11:17:10 AM EDT)
â„¹ï¸ Column 'away_team_y' not found. No changes made.
â¹ï¸ END: fix_away_team_column (2025-07-26 11:17:10 AM EDT)

â–¶ï¸ START: preprocess_pitcher_weather_park_away (2025-07-26 11:17:10 AM EDT)
â¹ï¸ END: preprocess_pitcher_weather_park_away (2025-07-26 11:17:10 AM EDT)

â–¶ï¸ START: add_team_alias_columns (2025-07-26 11:17:10 AM EDT)
[main 4bcd77e] Add team alias columns to pitcher files
 2 files changed, 2 insertions(+), 2 deletions(-)
âœ… Added 'home_team' to data/adjusted/pitchers_home.csv (0 rows)
âœ… Added 'away_team' to data/adjusted/pitchers_away.csv (0 rows)
ğŸ“ Log saved to log_add_team_alias_columns.txt
â¹ï¸ END: add_team_alias_columns (2025-07-26 11:17:10 AM EDT)

â–¶ï¸ START: add_team_columns_to_weather (2025-07-26 11:17:11 AM EDT)
âœ… Wrote home_team and away_team to data/weather_teams.csv
â¹ï¸ END: add_team_columns_to_weather (2025-07-26 11:17:11 AM EDT)

â–¶ï¸ START: apply_pitcher_weather_adjustment (2025-07-26 11:17:12 AM EDT)
âœ… Git commit and push complete for pitcher weather adjustments.
â¹ï¸ END: apply_pitcher_weather_adjustment (2025-07-26 11:17:12 AM EDT)

â–¶ï¸ START: apply_pitcher_park_adjustment (2025-07-26 11:17:12 AM EDT)
âœ… Wrote data/adjusted/pitchers_home_park.csv with 0 rows.
ğŸ“ Log written to log_pitchers_home_park.txt
âœ… Wrote data/adjusted/pitchers_away_park.csv with 0 rows.
ğŸ“ Log written to log_pitchers_away_park.txt
âœ… Git commit and push complete for pitcher park adjustments.
â¹ï¸ END: apply_pitcher_park_adjustment (2025-07-26 11:17:12 AM EDT)

â–¶ï¸ START: normalize_pitcher_merge_inputs (2025-07-26 11:17:13 AM EDT)
âœ… Normalized and saved: data/adjusted/pitchers_home_weather.csv
âœ… Normalized and saved: data/adjusted/pitchers_home_park.csv
âœ… Normalized and saved: data/adjusted/pitchers_away_weather.csv
âœ… Normalized and saved: data/adjusted/pitchers_away_park.csv
â¹ï¸ END: normalize_pitcher_merge_inputs (2025-07-26 11:17:13 AM EDT)

â–¶ï¸ START: combine_pitcher_weather_park_home (2025-07-26 11:17:14 AM EDT)
[main 91c4a6f] Auto-commit: Cleaned combine pitcher weather + park (home)
 1 file changed, 1 insertion(+), 1 deletion(-)
â¹ï¸ END: combine_pitcher_weather_park_home (2025-07-26 11:17:14 AM EDT)

â–¶ï¸ START: combine_pitcher_weather_park_away (2025-07-26 11:17:14 AM EDT)
[main 8da6e3d] Auto-commit: Cleaned combine pitcher weather + park (away)
 1 file changed, 1 insertion(+), 1 deletion(-)
â¹ï¸ END: combine_pitcher_weather_park_away (2025-07-26 11:17:14 AM EDT)

â–¶ï¸ START: prep_merge (2025-07-26 11:17:15 AM EDT)
[main 299e5bf] prep_merge: normalize team casing and enforce name match
 2 files changed, 2 insertions(+), 2 deletions(-)
âœ… Git commit and push complete.
âœ… Team and name normalization complete.
â¹ï¸ END: prep_merge (2025-07-26 11:17:15 AM EDT)

â–¶ï¸ START: chain_setup_inputs (2025-07-26 11:17:16 AM EDT)
Copying input files...
Copied: batters_home_weather_park.csv
Copied: batters_away_weather_park.csv
Copied: pitchers_home_weather_park.csv
Copied: pitchers_away_weather_park.csv
Copied: todaysgames_normalized.csv
All files copied.
â¹ï¸ END: chain_setup_inputs (2025-07-26 11:17:16 AM EDT)

â–¶ï¸ START: clean_and_preprocess_games (2025-07-26 11:17:16 AM EDT)
ğŸ”§ Cleaning and preprocessing game-level data...
âœ… Saved cleaned game data to: data/end_chain/cleaned/games_cleaned.csv
â¹ï¸ END: clean_and_preprocess_games (2025-07-26 11:17:16 AM EDT)

â–¶ï¸ START: normalize_games_pitchers (2025-07-26 11:17:17 AM EDT)
âœ… Normalized pitcher names written to data/end_chain/cleaned/games_cleaned.csv
â¹ï¸ END: normalize_games_pitchers (2025-07-26 11:17:17 AM EDT)

â–¶ï¸ START: normalize_pitchers_xtra (2025-07-26 11:17:17 AM EDT)
ğŸ”„ Normalizing names in pitchers_xtra.csv...
âœ… Output written to data/end_chain/cleaned/pitchers_xtra_normalized.csv
â¹ï¸ END: normalize_pitchers_xtra (2025-07-26 11:17:17 AM EDT)

â–¶ï¸ START: clean_merge_files (2025-07-26 11:17:17 AM EDT)
Cleaning file: data/end_chain/pitchers_home_weather_park.csv
ğŸ” Removed 0 duplicate rows in data/end_chain/pitchers_home_weather_park.csv
âœ… pitchers_home cleaned and saved.
Cleaning file: data/end_chain/pitchers_away_weather_park.csv
ğŸ” Removed 0 duplicate rows in data/end_chain/pitchers_away_weather_park.csv
âœ… pitchers_away cleaned and saved.
â¹ï¸ END: clean_merge_files (2025-07-26 11:17:17 AM EDT)

â–¶ï¸ START: chain_load_data (2025-07-26 11:17:18 AM EDT)
--- Starting Data Loading Process ---
Loading games from data/end_chain/todaysgames_normalized.csv...
âœ… Loaded games. Shape: (15, 5)
Loading batters_home from data/end_chain/batters_home_weather_park.csv...
âœ… Loaded batters_home. Shape: (125, 71)
Loading batters_away from data/end_chain/batters_away_weather_park.csv...
âœ… Loaded batters_away. Shape: (131, 112)
Loading pitchers_home from data/end_chain/pitchers_home_weather_park.csv...
âœ… Loaded pitchers_home. Shape: (0, 6)
Loading pitchers_away from data/end_chain/pitchers_away_weather_park.csv...
âœ… Loaded pitchers_away. Shape: (0, 6)
--- Data Loading Complete ---
â¹ï¸ END: chain_load_data (2025-07-26 11:17:18 AM EDT)

â–¶ï¸ START: rename_and_merge_pitcher_data (2025-07-26 11:17:18 AM EDT)
âœ… Cleaned and updated: pitchers_home_weather_park.csv
âœ… Cleaned and updated: pitchers_away_weather_park.csv
â¹ï¸ END: rename_and_merge_pitcher_data (2025-07-26 11:17:18 AM EDT)

â–¶ï¸ START: pit_clean1 (2025-07-26 11:17:18 AM EDT)
âœ… Updated names in pitchers_home_weather_park.csv
âœ… Updated names in pitchers_away_weather_park.csv
âœ… Synced 'home_team' with 'team' in batters_home_cleaned.csv
â¹ï¸ END: pit_clean1 (2025-07-26 11:17:18 AM EDT)

â–¶ï¸ START: merge_data (2025-07-26 11:17:19 AM EDT)
2025-07-26 15:17:19,388 - INFO - ğŸ”— Starting merge process...
2025-07-26 15:17:19,388 - INFO - â³ Loading batters_home from data/end_chain/cleaned/batters_home_cleaned.csv...
2025-07-26 15:17:19,390 - INFO - âœ… Loaded batters_home with 15 rows and 61 columns.
2025-07-26 15:17:19,391 - INFO - â³ Loading batters_away from data/end_chain/cleaned/batters_away_cleaned.csv...
2025-07-26 15:17:19,392 - INFO - âœ… Loaded batters_away with 15 rows and 61 columns.
2025-07-26 15:17:19,392 - INFO - â³ Loading pitchers_home from data/end_chain/cleaned/pitchers_home_cleaned.csv...
2025-07-26 15:17:19,394 - INFO - âœ… Loaded pitchers_home with 14 rows and 11 columns.
2025-07-26 15:17:19,394 - INFO - â³ Loading pitchers_away from data/end_chain/cleaned/pitchers_away_cleaned.csv...
2025-07-26 15:17:19,395 - INFO - âœ… Loaded pitchers_away with 15 rows and 11 columns.
2025-07-26 15:17:19,395 - INFO - â³ Loading games from data/end_chain/cleaned/games_cleaned.csv...
2025-07-26 15:17:19,396 - INFO - âœ… Loaded games with 15 rows and 5 columns.
2025-07-26 15:17:19,396 - INFO - ğŸ” Validating columns for games...
2025-07-26 15:17:19,396 - INFO - âœ… All required columns present in games.
2025-07-26 15:17:19,396 - INFO - ğŸ” Validating columns for batters_home...
2025-07-26 15:17:19,396 - INFO - âœ… All required columns present in batters_home.
2025-07-26 15:17:19,396 - INFO - ğŸ” Validating columns for batters_away...
2025-07-26 15:17:19,396 - ERROR - âŒ batters_away is missing required columns: ['team']
2025-07-26 15:17:19,396 - CRITICAL - âŒ Column validation failed: batters_away is missing required columns: ['team']
â¹ï¸ END: merge_data (2025-07-26 11:17:19 AM EDT)


===== ERRORS =====

âŒ validate_tagged_players ERROR (2025-07-26 11:16:58 AM EDT):
Traceback (most recent call last):
  File "/home/runner/work/sports-betting-site/sports-betting-site/scripts/validate_tagged_players.py", line 2, in <module>
    from pydantic import BaseModel, ValidationError
ModuleNotFoundError: No module named 'pydantic'

---

âŒ merge_data ERROR (2025-07-26 11:17:19 AM EDT):

---

